
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>substrate-benchmark-genesis 联合开发网 - pudn.com</title>

    <link href="/Public/m/css/bootstrap.min.css" rel="stylesheet">
    <link href="/Public/m/font-awesome/css/font-awesome.css" rel="stylesheet">

    <link href="/Public/m/css/animate.css" rel="stylesheet">
    <link href="/Public/m/css/style.css" rel="stylesheet">

	<link href="/Public/m/css/plugins/slick/slick.css" rel="stylesheet">
	<link href="/Public/m/css/plugins/slick/slick-theme.css" rel="stylesheet">

	

	<link href="/css/style.css" rel="stylesheet">

	<!-- Mainly scripts -->
	<script src="/Public/m/js/jquery-2.1.1.js"></script>
	<script src="/Public/m/js/bootstrap.min.js"></script>

	<script src="/Public/m/js/plugins/metisMenu/jquery.metisMenu.js"></script>
	<script src="/Public/m/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

	<!-- Custom and plugin javascript -->
	<script src="/Public/m/js/inspinia.js"></script>
	<script src="/Public/m/js/plugins/pace/pace.min.js"></script>
	
<META name="Keywords" content="substrate-benchmark-genesis 程序员 编程 源码 源代码 下载">

	
<META name="Description" content="substrate-benchmark-genesis 用于生成用于基准测试运行时的genesis配置的工具。">

</head>

<body>

<!-- /.main-container start -->

<div class="pace  pace-inactive">
  	<div class="pace-progress" data-progress-text="100%" data-progress="99" style="transform: translate3d(100%, 0px, 0px);">
  	<div class="pace-progress-inner"></div>
	</div>
	<div class="pace-activity"></div>
</div>

<div class="all-content">
	<div class="my-container top-navigation">
		<nav class="navbar navbar-static-top" role="navigation">
			<div class="navbar-header">
				<button aria-controls="navbar" aria-expanded="false" data-target="#navbar" data-toggle="collapse" class="navbar-toggle collapsed" type="button">
					<i class="fa fa-reorder"></i>
				</button>
				<a href="http://www.pudn.com" class="navbar-brand">联合开发网</a>
			</div>
			<div class="navbar-collapse collapse" id="navbar">
				<ul class="nav navbar-nav">
					<li>
						<a href="/" style="padding-right:8px;padding-left:8px;font-size:16px">首页</a>
					</li>
					<li>
						<a href="https://search.pudn.com" style="padding-right:8px;padding-left:8px;font-size:16px">搜索</a>
					</li>
				</ul>
               	<ul class="nav navbar-top-links navbar-right">
               							<li>
                       	<a href="/User/login.html">
                           	&nbsp; <i class="fa fa-sign-out"></i>登录
                       	</a>
                   	</li>
                   	<li>
                       	<a href="/User/reg.html"><i class="fa fa-sign-out"></i>注册
                       	</a>
                   	</li>
					               	</ul>
			</div>
		</nav>
	</div>
	<form action="https://search.pudn.com/Download" method="get">
	<div class="top-menu-line2">
		<div class="my-container">
			<a href=/Download/upload.html>上传</a>
			&nbsp; <a href=/User>管理</a>
			&nbsp; <a href=https://search.pudn.com/Download>搜索</a>
			&nbsp; <a href=/Guestbook>留言</a>
			<div class="input-group pull-right" style="max-width:200px;margin:3px 15px 0px 0px">
				<input type="text" name="keyword" maxlength=20 placeholder="请输入关键字" class="form-control input-sm">
				<span class="input-group-btn"> <button type="submit" class="btn btn-white input-sm" style="border:1px solid #AAA"><i class="fa fa-search"></i></button>
				</span>
			</div>
		</div>
	</div></form>



<div class="row wrapper white-bg">
	<div class="my-container">
			<div class="nav-dir" style="padding:10px 0px">
				<a href="/">Pudn.com</a>&nbsp;&gt;&nbsp;下载中心
				&nbsp;&gt;&nbsp;测试				&nbsp;&gt;&nbsp;<font color=red>substrate-benchmark-genesis</font>
			</div>


		<div class="row">
			<div class="col-xs-12 col-md-8">
				<div class="item-name">substrate-benchmark-genesis</div>
				<div class="item-keyword">
									</div>
				<div class="item-action">
					<div class="btn-group">
						<a href=/Download/dl/id/1687538695904158 target=_blank class="btn btn-primary btn-sm"><i class="fa fa-download"></i> 下载(<span id="down-count">0</span>)</a>
						<a href="###" class="btn btn-white btn-sm vote-up"><i class="fa fa-thumbs-up"></i> 赞(<span id="vote-up-count">2</span>) </a>
						<a href="###" class="btn btn-white btn-sm vote-down"><i class="fa fa-thumbs-down"></i> 踩(<span id="vote-down-count">0</span>) </a>
						<a href="/Download/comment/id/1687538695904158" data-toggle="modal" data-target="#myModal" class="btn btn-white btn-sm"><i class="fa fa-comment"></i> 评论(<span id="comment-count">0</span>) </a>
						<a href="###" class="btn btn-white btn-sm favor-item"><i class="fa fa-heart"></i> 收藏(<span id="favor-count">0</span>) </a>
					</div>
				</div>
				<hr>

				<div class="item-info">
					<B>所属分类</B>：测试<BR>
					<B>开发工具</B>：JavaScript<BR>
					<B>文件大小</B>：17902KB<BR>
					<B>下载次数</B>：0<BR>
					<B>上传日期</B>：2021-03-10 12:00:21<BR>
					<B>上 传 者</B>：<a href=/User/profile/id/1682139907912860.html>sh-1993</a><BR>
				</div>
				<div class="item-intro">
					说明：&nbsp;&nbsp;用于生成用于基准测试运行时的genesis配置的工具。<BR>(A tool to generate a genesis configuration used for benchmarking the runtime.)				</div>
				<hr>
				<div><B>文件列表</B>: </div>
				<div id="file-list">
				LICENSE (1070, 2020-04-29)<BR>input (0, 2020-04-29)<BR>input\kusama-dev.<B>json</B> (4630556, 2020-04-29)<BR>input\substrate-dev-db-clean.<B>json</B> (4174533, 2020-04-29)<BR>js (0, 2020-04-29)<BR>js\create_genesis.<B>js</B> (2585, 2020-04-29)<BR>js\get_metadata.<B>js</B> (9816, 2020-04-29)<BR>js\sort_top.<B>js</B> (659, 2020-04-29)<BR>output (0, 2020-04-29)<BR>output\kusama-dev-final.<B>json</B> (98159156, 2020-04-29)<BR>output\storage-metadata-parity-polkadot-development-polkadot.<B>json</B> (29454, 2020-04-29)<BR>output\storage_metadata.<B>json</B> (20220, 2020-04-29)<BR>output\storage_metadata_only_accounts.<B>json</B> (296, 2020-04-29)<BR>package.<B>json</B> (658, 2020-04-29)<BR>yarn.<B>lock</B> (29461, 2020-04-29)<BR>				</div>
				<hr>
				<div id="readme">
				# substrate-benchmark-genesis

This is a tool to generate keys and values for a Substrate Chain Spec file, intended for
benchmarking the runtime given a "full chain".

It uses a two step process to generate the final chain specification:

1. Query the chain metadata and populate a list of available Storage Maps / Double Maps.
    * This file has a spot for users to note how many of that item we want to generate.
2. Generate a final chain spec using a basic chain spec and the metadata file.

More details about these two steps below.

To install the npm packages needed to run this tool, simply type `yarn`:

```bash
$ yarn

  substrate-benchmark-genesis git:(master) — yarn
yarn install v1.22.4
[1/4] ”  Resolving packages...
success Already up-to-date.
¨  Done in 0.15s.
```

## Get Metadata

Each Substrate chain is unique, and as such, will need to generate different data and amounts of
data to accurately benchmark the runtime logic. To do this, we use Polkadot JS API to query the
node's metadata to retrieve all storage items and their respective prefix.

To generate the `storage_metadata` file, run a local node (using port `9944` which is default), and
then run:

```bash
yarn run metadata <option>
```

> `<option>` is an optional parameter which currently supports `polkadot` (generating a chainspec
> given the estimated fullness of the Polkadot mainnet) or `accounts` (generating only 10_000
> accounts).
>
> By default, when you omit this parameter, all storage items will be set to generate zero items,
> which is a good template for adding your own values.

It should generate a new `storage_metadata` file in the `output` folder with the storage contents of
your chain.

The output for a single storage item will look like this:

```json
{
  "module": "system",
  "storage": "account",
  "type": {
    "Map": {
      "hasher": "Blake2_128Concat",
      "key": "AccountId",
      "value": "AccountInfo",
      "linked": false
    }
  },
  "prefix": "0x26aa394eea5630e07c48ae0c9558cef7b99d880ec681799c0cf30e8886371da9",
  "generate": 100000
},
```

Here you will see we have the `module` and `storage` name, along with the kind of storage item it is
(with additional metadata), the final prefix of the key, and the number of keys we want to generate
for this runtime storage item.

You should generate this metadata once your runtime is finalized, and then populate the `generate`
field for your custom needs.

From there, you can reuse this storage metadata file to generate "full" chain specs of your runtime
if you make changes that would not affect the metadata file, i.e. performance improvements.

Once you have a populated `storage_metadata` file, it is now time to generate a "full" chain spec.

## Generate a Chain Spec

To generate a "full" chain spec file, you need to provide a basic chain spec on top of which we will
populate the additional storage items.

You can generate a simple default chain specification by building your Substrate with
`runtime-benchmarks` enabled:

```bash
cargo build --release --features runtime-benchmarks
```

> **NOTE:** Having this feature flag enabled is critically important. For benchmarking, we will
> directly use the Wasm provided in your chain specification, and if you do not have the
> benchmarking feature enabled, you wont be able to run benchmarks using the chain spec you
> generate.
>
> As you change and modify your runtime, you will need to also update this Wasm by creating a new
> "base" chain specification. However, it should be easy to generate new "full" chain specifications
> due to the two step process in this tool.

Then generate a chain spec with:

```bash
./target/release/my_node build-spec --chain dev --raw > my_node_spec.json
```

This will create a basic chain specification that contains anything a regular dev chain will:

* Maybe a few funded accounts (Alice, Bob, Charlie...).
* Alice as the single permanent validator.
* The Runtime Wasm stored in the `:CODE` storage key.
* etc...

Take this chain chain spec and your `storage_metadata` file, and run the following:

```bash
yarn run generate <path-to-chain-spec> <path-to-storage-metadata>
```

We will then generate the keys you have specified and populate them into a new chain spec ending
with `-final.json`. You can now use this chain specification for running benchmarks like so:

```bash
./target/release/my_node benchmark
    --chain my_node_spec-final.json \
    --execution=wasm --wasm-execution=compiled \
    --pallet balances \
    --extrinsic transfer \
    --steps 20 \
    --repeat 20 \
> balance-transfer.txt
```

## Assumptions

This tool makes some critical (maybe not 100% proven) assumptions about generating the chain
specification.

The critical assumption here is that the actual keys and values that it generates are **not** real,
i.e. they may not properly encode or decode to the format expected by the runtime.

Instead, we assume that simulating a "full" trie simply means inducing multiple storage hops to
access a storage item. And to do this, we simply need random keys populated under the main storage
prefix of these storage items.

For example, when we generate a bunch of system accounts, we know from the `storage_metadata` that
all the account storage items are stored under shared prefix:

```bash
0x26aa394eea5630e07c48ae0c9558cef7b99d880ec681799c0cf30e8886371da9
```

So we simply want to create additional storage items with this prefix, and some random suffix:

```bash
0x26aa394eea5630e07c48ae0c9558cef7b99d880ec681799c0cf30e8886371da900
0x26aa394eea5630e07c48ae0c9558cef7b99d880ec681799c0cf30e8886371da901
0x26aa394eea5630e07c48ae0c9558cef7b99d880ec681799c0cf30e8886371da902
...
0x26aa394eea5630e07c48ae0c9558cef7b99d880ec681799c0cf30e8886371da9ff
```

Building these 256 storage items means that accessing any _real_ account should take an additional
two storage hops because we have created these extra nodes. We populate these keys with the same ***
bit randomness appended to the end of the prefix, but this can be modified in the source.

Because we never actually use or decode these extra storage items, their key and value need not be
accurate. Do note though, if you expect these nodes to be particularly heavy, *** bits may not be
large enough to simulate real world behavior.

We only populate Storage Maps and Double Maps with this tool. This means that if your runtime has
some Vecs, those are currently not populated, but this might change in the future.
				</div>
				<hr>
				<div><B>近期下载者</B>：</div>
				<div id="download-users"></div>
				<hr>
				<div><B>相关文件</B>：</div>
				<div id="relate-items"></div>
				<hr>
				<div><B>评论</B>：[<a href=/Download/comment/id/1687538695904158.html data-toggle=modal data-target="#myModal">我要评论</a>]&nbsp;[<a class='pop-a' href=/Download/report/id/1687538695904158.html>举报此文件</a>]</div>
				<div id="file-comments"></div>
				<hr>
				<div><B>收藏者</B>：</div>
				<div id="favor-users"></div>
				<p></p>
			</div>

			<div class="col-xs-12 col-md-4">

				<div class="ad-sidebar text-center">
					<div class="ad-300">
					</div>
				</div>
			</div>
		</div>

	</div>
</div>



	<div class="my-footer">
		<div class="container">
		<div class="pull-right">
		</div>

		<div>
			
			<a href="http://www.pudn.com" target=_blank>© 联合开发网 from 2004</a> | 
			<a href="/Index/contact.html">联系站长</a> | 
			<a href=" https://beian.miit.gov.cn" target=_blank>湘ICP备2023001425号</a> | 
			<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=43010502000604" target=_blank>网安备43010502000604</a> | 
		</div>
		</div>
	</div>


</div><!-- /wrapper-->




<!-- page specific plugin scripts -->

<!-- inline scripts related to this page -->

<div id="myModal" class="modal fade" tabindex="-1" 
			role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			
		</div>
	</div>
</div><!-- /.modal-table -->

</body>

<script type="text/javascript">
$(document).on('click', '.list-more', function(){
	var id=$(this).attr('data-id');
	$('#list-'+id).css('max-height',$('#list-'+id)[0].scrollHeight);
	$(this).removeClass('list-more');
	$(this).addClass('list-hide');
	$(this).html('<i class="fa fa-angle-double-up"></i>');
	
	//$(this).hide();

	return false;
});

$(document).on('click', '.list-hide', function(){
	var id=$(this).attr('data-id');
	$('#list-'+id).css('max-height','100px');
	$(this).removeClass('list-hide');
	$(this).addClass('list-more');
	$(this).html('<i class="fa fa-angle-double-down"></i>');
	
	return false;
});

$("#myModal").on("hidden.bs.modal", function() {
    $(this).removeData();
});

$(document).on("click",".keyword",function(){
	var keyword=$(this).attr("keyword");
	var type_id=$(this).attr("type_id");
	if(typeof(type_id) =="undefined" || type_id =="") type_id="0";
	location.href="http://search.pudn.com/Download/index?keyword="+keyword;
	
	return false;
});
</script>
<script type="text/javascript" src="/js/time.js"></script>


<script type="text/javascript" src="/js/marked.min.js"></script>
<script type="text/javascript">
	$(document).ready(function(){
		$('.hide-list').each(function(){
			if ($(this)[0].offsetHeight < $(this)[0].scrollHeight){
				var id=$(this).attr('id');
				id =id.substring(5);
				$(this).after('<div style="text-align:center"><a href="" class="list-more" data-id="' + id + '"><i class="fa fa-angle-double-down"></i></a></div>');
			}
		});
	});
	var g_id="1687538695904158";
	var keywords =new Array();
		function get_download_user(){
		var url ="/Download/get_download_user/id/"+g_id+".html";
		$.get(url,function(ret){
			if(ret.length ==0) return;
			var html='';
			for(i in ret){
				html =html + '<a href=/User/profile/id/'+ret[i].user_new_id+'.html>'+ret[i].name+'</a> ';
			}
			$('#download-users').append(html);
		});
	}
	
	function get_relate_item(){
		var url ="/Download/get_relate_item/id/"+g_id+'.html';
		$.get(url,function(ret){
			if(ret.length ==0) return;
			var html='';
			var intro;
			for(i in ret){
				intro =ret[i].intro;
				for(j in keywords){
					var reg =new RegExp(keywords[j],'gmi');
					intro =intro.replace(reg,'<font color=brown>'+keywords[j]+'</font>');
				}
				html =html + '[<a href=/Download/item/id/'+ret[i].new_id+'.html>'+ret[i].name+'</a>]&nbsp; '+intro+'<BR>';
			}
			$('#relate-items').append(html);
		});
		
	}
	function get_score_name(score){
		switch(score){
		case '100': return '很好，推荐下载';
		case '85': return '还不错';
		case '75': return '一般，勉强可用';
		case '50': return '差';
		case '3': return '纯粹是垃圾';
		case '40': return '和说明完全不符';
		case '20': return '文件不全';
		case '10': return '不是源代码或资料';
		case '5': return '文件有密码，不知道密码';
		case '0': return '不能解压或下载失败';
		}
		return '';
	}
	function get_comment(){
		var url ="/Download/get_comments/id/"+g_id+'.html';
		$.get(url,function(ret){
			if(ret.length ==0) return;
			var total_count =ret.total_count;
			var data =ret.data;
			var html='';
			for(i in data){
				html =html + '<a href="/User/profile/id/'+data[i].user_new_id+'.html" class="uploader">'+data[i].user_name+'</a>: <span class="comment-score">'+get_score_name(data[i].score)+'</span>, '+data[i].content+'<BR>';
			}
			$('#file-comments').append(html);
		});
		
	}
	function get_favor(){
		var url ="/Download/get_item_favors/id/"+g_id+".html";
		$.get(url,function(ret){
			if(ret.length ==0) return;
			var html='';
			for(i in ret){
				html =html + '<a href=/User/profile/id/'+ret[i].user_new_id+'.html class=user>'+ret[i].name+'</a>&nbsp;';
			}
			$('#favor-users').html(html);
		});
	}
	// 得到下载这个的用户又下载了什么
	function get_more_download(){
		
	}
	// 得到下载这个的用户又搜索了什么
	function get_more_keyword(){
		
	}
	
	// 得到论坛相关问题
	function get_bbs(){
		
	}
	
	// 得到软件工场相关内容
	function get_works(){
		
	}
	
	// 得到相关聊天室
	function get_chat(){
		
	}
	
	// 得到相关软件商城信息
	function get_shop(){
		
	}
	
	// 得到job
	
	// 得到学习内容

	// 数据
	get_download_user();
	//get_relate_item();
	get_comment();
	get_favor();
	
	$('.vote-up').click(function(){
		var url="/Download/vote/t/up/id/"+g_id;
		$.get(url,function(ret){
			if(ret.status==0){
				alert(ret.info);
				if(ret.url.length >0)
					location.href=ret.url;
			}
			else{
				var s =$('#vote-up-count').html();
				if(s =='') s="0";
				var count =parseInt(s)+1;
				$('#vote-up-count').html(count);
			}
		})
		return false;
	});
	$('.vote-down').click(function(){
		var url="/Download/vote/t/down/id/"+g_id;
		$.get(url,function(ret){
			if(ret.status==0)
				alert(ret.info);
			else{
				var s =$('#vote-down-count').html();
				if(s =='') s="0";
				var count =parseInt(s)+1;
				$('#vote-down-count').html(count);
			}
		})
		return false;
	});
	$('.favor-item').click(function(){
		var url="/Favor/add/t/0/id/"+g_id;
		$.get(url,function(ret){
			if(ret.status==0){
				alert(ret.info);
			}
			else{
				var s =$('#favor-count').html();
				if(s =='') s="0";
				var count =parseInt(s)+1;
				$('#favor-count').html(count);
			}
		})
		return false;
	});
	$('.pop-a').click(function(){
		var url=$(this).attr('href');
		$.get(url,function(ret){
			alert(ret.info);
			//location.reload();
		})
		return false;
	});

document.getElementById('readme').innerHTML =marked.parse(document.getElementById('readme').innerHTML);
</script>



</html>